En Windows, generar carpeta con cada tarea en un XML

# This creates a folder and saves each task as its own XML file
New-Item -ItemType Directory -Force -Path ".\TaskBackups"
Get-ScheduledTask | ForEach-Object {
    $xml = Export-ScheduledTask -TaskName $_.TaskName -TaskPath $_.TaskPath
    $filename = ($_.TaskName -replace '[\\/:*?"<>|]', '_') + ".xml"
    $xml | Out-File -FilePath ".\TaskBackups\$filename"
}



Para descargar el XML usa:
schtasks /Query /XML > all_tasks.xml


Para un CSV usa:
Get-ScheduledTask | Export-Csv -Path "all_tasks.csv" -NoTypeInformation
